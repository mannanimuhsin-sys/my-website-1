<!DOCTYPE html>
<html lang="ml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKSSF SAMASTHA QUIZ</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #004d00; --gold: #D4AF37; --bg: #f8f9fa; }
        body { font-family: 'Poppins', sans-serif; background: var(--bg); margin: 0; }
        
        .header { background: linear-gradient(135deg, #004d00, #007d00); color: white; text-align: center; padding: 40px 20px; border-radius: 0 0 40px 40px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        
        .container { max-width: 500px; margin: -30px auto 50px; background: white; padding: 25px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-top: 5px solid var(--gold); position: relative; }
        
        .btn { width: 100%; padding: 15px; border: none; border-radius: 12px; font-weight: bold; cursor: pointer; color: white; background: var(--primary); margin-top: 10px; transition: 0.3s; font-size: 16px; }
        .btn:disabled { background: #ccc; cursor: not-allowed; }
        
        input, select { width: 100%; padding: 14px; margin-bottom: 15px; border: 1.5px solid #ddd; border-radius: 12px; box-sizing: border-box; font-size: 15px; outline: none; }
        input:focus { border-color: var(--primary); }
        
        #countdown { font-size: 35px; font-weight: 800; color: #d32f2f; text-align: center; margin: 20px 0; font-family: monospace; }
        
        .q-box { background: #f9f9f9; padding: 18px; border-radius: 15px; margin-bottom: 15px; border: 1px solid #eee; }
        .q-box b { display: block; margin-bottom: 12px; font-size: 17px; color: #333; }
        
        .option-label { display: block; padding: 10px; background: white; margin-bottom: 8px; border-radius: 10px; border: 1px solid #ddd; cursor: pointer; transition: 0.2s; }
        .option-label:hover { background: #f0f7f0; border-color: var(--primary); }

        #poster-zone { display: none; text-align: center; margin-top: 20px; border: 2px solid var(--gold); padding: 20px; border-radius: 20px; background: #fffdf0; animation: fadeIn 0.8s ease; }
        canvas { width: 100%; border-radius: 12px; box-shadow: 0 8px 25px rgba(0,0,0,0.3); margin-bottom: 20px; }
        
        #regNumBox { display: none; text-align: center; padding: 20px; background: #fff9c4; margin-top: 15px; border-radius: 15px; border: 2px dashed var(--gold); }
        
        footer { text-align: center; padding: 30px; font-size: 13px; color: #666; border-top: 1px solid #eee; margin-top: 20px; }
        
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="header">
    <h1 style="margin:0; font-size:24px; letter-spacing: 1px;">SAMASTHA QUIZ PROGRAM</h1>
    <p style="color:var(--gold); margin:5px 0; font-weight:bold; font-size: 14px;">SKSSF CHAPPARAPPADAV ZONE</p>
</div>

<div class="container">
    <div id="authPanel">
        <div style="display:flex; gap:10px; margin-bottom:20px;">
            <button class="btn" id="tabReg" onclick="showTab('reg')">‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº</button>
            <button class="btn" id="tabLog" style="background:#444;" onclick="showTab('log')">‡¥≤‡µã‡¥ó‡¥ø‡µª</button>
        </div>
        
        <div id="regPart">
            <input type="text" id="regName" placeholder="‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥™‡µá‡¥∞‡µç">
            <input type="number" id="regMobile" placeholder="‡¥Æ‡µä‡¥¨‡µà‡µΩ ‡¥®‡¥Æ‡µç‡¥™‡µº">
            <select id="regBranch">
                <option value="">‡¥∂‡¥æ‡¥ñ ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï</option>
                <option>KARUVANCHAL</option><option>VILAKKANNOOR</option><option>CHAPPARAPPADAV</option>
                <option>NADUVIL</option><option>PADAPPENGAD</option><option>PERUVANA</option>
                <option>ELAMBERAM PARA</option><option>ERUVATTI</option><option>NHANDUMBALAM</option>
                <option>PERUMALABAD</option><option>MANGARA BADARIYYA</option><option>THADIKKADAV</option>
                <option>SHANTHIGIRI</option><option>NEDUVOODE</option>
            </select>
            <button class="btn" id="regBtn" onclick="handleRegister()">‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï</button>
            <div id="regNumBox">
                <p style="margin:0; font-weight:bold; color:green;">‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥ü‡µç‡¥∞‡µá‡¥∑‡µª ‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ø‡¥ö‡µç‡¥ö‡µÅ!</p>
                ‡¥®‡¥ø‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥ü‡µÜ ‡¥ê‡¥°‡¥ø ‡¥®‡¥Æ‡µç‡¥™‡µº: <h2 id="displayRegNum" style="margin:5px 0; color:#d32f2f; font-size: 45px;"></h2>
                <p style="font-size: 12px; color: #555;">‡¥à ‡¥®‡¥Æ‡µç‡¥™‡µº ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï.</p>
            </div>
        </div>

        <div id="logPart" style="display:none;">
            <input type="number" id="logId" placeholder="‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº ‡¥®‡¥Æ‡µç‡¥™‡µº (ID) ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï">
            <button class="btn" onclick="handleLogin()">‡¥ï‡µç‡¥µ‡¥ø‡¥∏‡µç‡¥∏‡¥ø‡¥≤‡µá‡¥ï‡µç‡¥ï‡µç ‡¥™‡µç‡¥∞‡¥µ‡µá‡¥∂‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï</button>
        </div>
    </div>

    <div id="quizView" style="display:none;">
        <div id="userInfo" style="background:#e8f5e9; padding:15px; border-radius:15px; text-align:center; margin-bottom:20px; font-weight:bold; border: 1px solid #c8e6c9; color: #2e7d32;"></div>
        
        <div id="timerDisplay">
            <p style="text-align:center; font-weight:bold; color: #666; margin-bottom: 0;">‡¥Æ‡¥§‡µç‡¥∏‡¥∞‡¥Ç ‡¥§‡µÅ‡¥ü‡¥ô‡µç‡¥ô‡¥æ‡µª ‡¥á‡¥®‡¥ø:</p>
            <div id="countdown">00:00:00</div>
        </div>

        <div id="quizArea" style="display:none;">
            <div id="questionList"></div>
            <button class="btn" id="submitBtn" onclick="submitQuiz()">‡¥â‡¥§‡µç‡¥§‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥∏‡¥Æ‡µº‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï (Submit)</button>
        </div>

        <div id="poster-zone">
            <h3 style="color:#004d00; font-size: 26px; margin-bottom: 10px;">‡¥Ö‡¥≠‡¥ø‡¥®‡¥®‡µç‡¥¶‡¥®‡¥ô‡µç‡¥ô‡µæ! üéâ</h3>
            <p style="font-weight: bold; color: #444;">‡¥§‡¥æ‡¥ô‡µç‡¥ï‡µæ ‡¥à ‡¥Æ‡¥§‡µç‡¥∏‡¥∞‡¥§‡µç‡¥§‡¥ø‡¥≤‡µÜ ‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ø‡¥Ø‡¥æ‡¥Ø‡¥ø ‡¥§‡¥ø‡¥∞‡¥û‡µç‡¥û‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ.</p>
            <canvas id="winnerCanvas" width="1000" height="1250"></canvas>
            <button class="btn" style="background: #D4AF37; color: black; font-size: 18px; box-shadow: 0 4px 10px rgba(0,0,0,0.2);" onclick="downloadPoster()">
                <i class="fa fa-download"></i> POSTER ‡¥°‡µó‡µ∫‡¥≤‡µã‡¥°‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï
            </button>
        </div>

        <div id="statusMessage" style="display:none; text-align:center; padding:40px 20px;">
            <i id="statusIcon" class="fa fa-info-circle" style="font-size: 50px; color: #ccc; margin-bottom: 15px;"></i>
            <h3 id="statusTitle">‡¥ï‡¥æ‡¥§‡µç‡¥§‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï...</h3>
            <p id="statusDesc">‡¥ï‡µç‡¥µ‡¥ø‡¥∏‡µç ‡¥´‡¥≤‡¥ô‡µç‡¥ô‡µæ ‡¥â‡¥ü‡µª ‡¥™‡µç‡¥∞‡¥∏‡¥ø‡¥¶‡µç‡¥ß‡µÄ‡¥ï‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥Ç.</p>
        </div>
    </div>
</div>

<footer>
    <b>System Developed By: MUHSIN MANNANI</b><br>
    SKSSF Chapparappadav Zone
</footer>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyCS9jqJEr_umK_goyXuf3njYCE_Cb8xU7o",
  authDomain: "skssf-quiz.firebaseapp.com",
  projectId: "skssf-quiz",
  storageBucket: "skssf-quiz.firebasestorage.app",
  messagingSenderId: "999161549501",
  appId: "1:999161549501:web:7be9c98c287b92881a5dd4"
};
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

let currentUser = null;

function showTab(t) {
    document.getElementById('regPart').style.display = (t==='reg')?'block':'none';
    document.getElementById('logPart').style.display = (t==='log')?'block':'none';
    document.getElementById('tabReg').style.background = (t==='reg')? '#004d00':'#444';
    document.getElementById('tabLog').style.background = (t==='log')? '#004d00':'#444';
}

// 1. Register with Mobile & Unique Check
async function handleRegister() {
    const name = document.getElementById('regName').value.trim();
    const mob = document.getElementById('regMobile').value.trim();
    const branch = document.getElementById('regBranch').value;
    
    if(!name || !mob || !branch) return alert("‡¥é‡¥≤‡µç‡¥≤‡¥æ ‡¥ï‡µã‡¥≥‡¥ô‡µç‡¥ô‡¥≥‡µÅ‡¥Ç ‡¥™‡µÇ‡¥∞‡¥ø‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï!");
    if(mob.length < 10) return alert("‡¥∏‡¥æ‡¥ß‡µÅ‡¥µ‡¥æ‡¥Ø ‡¥Æ‡µä‡¥¨‡µà‡µΩ ‡¥®‡¥Æ‡µç‡¥™‡µº ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï!");

    const btn = document.getElementById('regBtn');
    btn.disabled = true;
    btn.innerText = "‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥ï‡¥æ‡¥§‡µç‡¥§‡¥ø‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µÇ...";

    try {
        // Mobile Unique Check
        const mobCheck = await db.collection("participants").where("mobile", "==", mob).get();
        if(!mobCheck.empty) {
            alert("‡¥à ‡¥Æ‡µä‡¥¨‡µà‡µΩ ‡¥®‡¥Æ‡µç‡¥™‡µº ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥®‡µá‡¥∞‡¥§‡µç‡¥§‡µÜ ‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº ‡¥ö‡µÜ‡¥Ø‡µç‡¥§‡¥§‡¥æ‡¥£‡µç!");
            btn.disabled = false;
            btn.innerText = "‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï";
            return;
        }

        const snap = await db.collection("participants").get();
        let nextId = 101;
        if(!snap.empty) {
            let ids = snap.docs.map(d => parseInt(d.id)).filter(id => !isNaN(id));
            if(ids.length > 0) nextId = Math.max(...ids) + 1;
        }

        const userData = { name, mobile: mob, branch, regId: nextId, createdAt: firebase.firestore.FieldValue.serverTimestamp() };
        await db.collection("participants").doc(nextId.toString()).set(userData);
        
        document.getElementById('displayRegNum').innerText = nextId;
        document.getElementById('regNumBox').style.display = 'block';
        btn.style.display = 'none';
        document.getElementById('regPart').querySelectorAll('input, select').forEach(el => el.disabled = true);
        
    } catch (e) {
        alert("‡¥™‡¥ø‡¥∂‡¥ï‡µç ‡¥∏‡¥Ç‡¥≠‡¥µ‡¥ø‡¥ö‡µç‡¥ö‡µÅ! ‡¥µ‡µÄ‡¥£‡µç‡¥ü‡µÅ‡¥Ç ‡¥∂‡µç‡¥∞‡¥Æ‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.");
        btn.disabled = false;
    }
}

// 2. Login with One-Time Participation Check
async function handleLogin() {
    const id = document.getElementById('logId').value.trim();
    if(!id) return alert("‡¥ê‡¥°‡¥ø ‡¥®‡¥Æ‡µç‡¥™‡µº ‡¥®‡µΩ‡¥ï‡µÅ‡¥ï!");
    
    try {
        const doc = await db.collection("participants").doc(id).get();
        if(!doc.exists) return alert("‡¥à ‡¥ê‡¥°‡¥ø ‡¥®‡¥ø‡¥≤‡¥µ‡¥ø‡¥≤‡¥ø‡¥≤‡µç‡¥≤. ‡¥¶‡¥Ø‡¥µ‡¥æ‡¥Ø‡¥ø ‡¥∞‡¥ú‡¥ø‡¥∏‡µç‡¥±‡µç‡¥±‡µº ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡µÅ‡¥ï.");

        // Check if already played
        const resCheck = await db.collection("results").doc(id).get();
        if(resCheck.exists) {
            alert("‡¥®‡¥ø‡¥ô‡µç‡¥ô‡µæ ‡¥à ‡¥ê‡¥°‡¥ø ‡¥â‡¥™‡¥Ø‡µã‡¥ó‡¥ø‡¥ö‡µç‡¥ö‡µç ‡¥í‡¥∞‡¥ø‡¥ï‡µç‡¥ï‡µΩ ‡¥ï‡µç‡¥µ‡¥ø‡¥∏‡µç‡¥∏‡¥ø‡µΩ ‡¥™‡¥ô‡µç‡¥ï‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥§‡¥æ‡¥£‡µç. ‡¥á‡¥®‡¥ø ‡¥™‡¥ô‡µç‡¥ï‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡¥æ‡µª ‡¥∏‡¥æ‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡¥ø‡¥≤‡µç‡¥≤!");
            return;
        }

        currentUser = doc.data();
        document.getElementById('authPanel').style.display = 'none';
        document.getElementById('quizView').style.display = 'block';
        document.getElementById('userInfo').innerText = `‡¥™‡µá‡¥∞‡µç: ${currentUser.name} | ‡¥∂‡¥æ‡¥ñ: ${currentUser.branch}`;

        // Listen for Admin Updates (Publish/Stop)
        db.collection("quiz_settings").doc("status").onSnapshot(d => {
            const s = d.data() || {};
            if(s.closed) {
                checkWinnerStatus();
            } else {
                runTimer(s.startTime, s.published);
            }
        });

    } catch (e) {
        alert("‡¥≤‡µã‡¥ó‡¥ø‡µª ‡¥™‡¥∞‡¥æ‡¥ú‡¥Ø‡¥™‡µç‡¥™‡µÜ‡¥ü‡µç‡¥ü‡µÅ!");
    }
}

function runTimer(startTime, published) {
    if(!startTime) return;
    const target = new Date(startTime).getTime();
    
    const timer = setInterval(() => {
        const now = new Date().getTime();
        const dist = target - now;
        
        if(dist <= 0) {
            clearInterval(timer);
            document.getElementById('timerDisplay').style.display = 'none';
            if(published) {
                document.getElementById('quizArea').style.display = 'block';
                document.getElementById('statusMessage').style.display = 'none';
                loadQuestions();
            } else {
                document.getElementById('statusMessage').style.display = 'block';
                document.getElementById('statusTitle').innerText = "‡¥§‡¥Ø‡µç‡¥Ø‡¥æ‡¥±‡µÜ‡¥ü‡µÅ‡¥ï‡µç‡¥ï‡µÅ‡¥ï...";
                document.getElementById('statusDesc').innerText = "‡¥Ö‡¥°‡µç‡¥Æ‡¥ø‡µª ‡¥™‡¥¨‡µç‡¥≤‡¥ø‡¥∑‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥§ ‡¥∂‡µá‡¥∑‡¥Ç ‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥ô‡µç‡¥ô‡µæ ‡¥ï‡¥æ‡¥£‡¥æ‡¥Ç.";
            }
        } else {
            const h = Math.floor(dist/(1000*60*60));
            const m = Math.floor((dist%(1000*60*60))/(1000*60));
            const s = Math.floor((dist%(1000*60))/1000);
            document.getElementById('countdown').innerHTML = 
                (h<10?'0'+h:h) + ":" + (m<10?'0'+m:m) + ":" + (s<10?'0'+s:s);
        }
    }, 1000);
}

async function loadQuestions() {
    if(document.getElementById('questionList').innerHTML !== "") return;
    const snap = await db.collection("questions").get();
    let html = "";
    snap.forEach(doc => {
        const q = doc.data();
        html += `<div class="q-box">
            <b>${q.text}</b>
            ${q.options.map((o,i) => `
                <label class="option-label">
                    <input type="radio" name="q_${doc.id}" value="${i}"> ${o}
                </label>
            `).join('')}
        </div>`;
    });
    document.getElementById('questionList').innerHTML = html || "‡¥ö‡µã‡¥¶‡µç‡¥Ø‡¥ô‡µç‡¥ô‡µæ ‡¥≤‡¥≠‡µç‡¥Ø‡¥Æ‡¥≤‡µç‡¥≤.";
}

async function submitQuiz() {
    const btn = document.getElementById('submitBtn');
    btn.disabled = true;
    btn.innerText = "‡¥∏‡¥Æ‡µº‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥®‡µç‡¥®‡µÅ...";

    let answers = {};
    const boxes = document.querySelectorAll('.q-box');
    boxes.forEach(box => {
        const input = box.querySelector('input');
        if(input) {
            const qid = input.name.split('_')[1];
            const selected = box.querySelector('input:checked');
            answers[qid] = selected ? selected.value : null;
        }
    });

    try {
        await db.collection("results").doc(currentUser.regId.toString()).set({ 
            ...currentUser, 
            answers: answers, 
            submitTime: firebase.firestore.FieldValue.serverTimestamp() 
        });
        alert("‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ï‡¥∞‡¥Æ‡¥æ‡¥Ø‡¥ø ‡¥∏‡¥¨‡µç‡¥Æ‡¥ø‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥§‡µÅ!");
        location.reload();
    } catch (e) {
        alert("‡¥∏‡¥¨‡µç‡¥Æ‡¥ø‡¥±‡µç‡¥±‡µç ‡¥ö‡µÜ‡¥Ø‡µç‡¥Ø‡¥æ‡µª ‡¥∏‡¥æ‡¥ß‡¥ø‡¥ö‡µç‡¥ö‡¥ø‡¥≤‡µç‡¥≤. ‡¥®‡µÜ‡¥±‡µç‡¥±‡µç‡¥µ‡µº‡¥ï‡µç‡¥ï‡µç ‡¥™‡¥∞‡¥ø‡¥∂‡µã‡¥ß‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï.");
        btn.disabled = false;
        btn.innerText = "‡¥â‡¥§‡µç‡¥§‡¥∞‡¥ô‡µç‡¥ô‡µæ ‡¥∏‡¥Æ‡µº‡¥™‡µç‡¥™‡¥ø‡¥ï‡µç‡¥ï‡µÅ‡¥ï";
    }
}

async function checkWinnerStatus() {
    document.getElementById('timerDisplay').style.display = 'none';
    document.getElementById('quizArea').style.display = 'none';
    
    const winDoc = await db.collection("winners").doc("list").get();
    if(winDoc.exists) {
        const winners = winDoc.data().winnerIds || [];
        if(winners.includes(currentUser.regId.toString())) {
            showWinnerPoster();
        } else {
            document.getElementById('statusMessage').style.display = 'block';
            document.getElementById('statusIcon').className = "fa fa-trophy";
            document.getElementById('statusIcon').style.color = "#D4AF37";
            document.getElementById('statusTitle').innerText = "‡¥Æ‡¥§‡µç‡¥∏‡¥∞‡¥Ç ‡¥Ö‡¥µ‡¥∏‡¥æ‡¥®‡¥ø‡¥ö‡µç‡¥ö‡µÅ";
            document.getElementById('statusDesc').innerText = "‡¥™‡¥ô‡µç‡¥ï‡µÜ‡¥ü‡µÅ‡¥§‡µç‡¥§‡¥§‡¥ø‡¥®‡µç ‡¥®‡¥®‡µç‡¥¶‡¥ø. ‡¥µ‡¥ø‡¥ú‡¥Ø‡¥ø‡¥ï‡¥≥‡µÜ ‡¥™‡µç‡¥∞‡¥ñ‡µç‡¥Ø‡¥æ‡¥™‡¥ø‡¥ö‡µç‡¥ö‡µÅ ‡¥ï‡¥¥‡¥ø‡¥û‡µç‡¥û‡µÅ.";
        }
    } else {
        document.getElementById('statusMessage').style.display = 'block';
    }
}

function showWinnerPoster() {
    document.getElementById('statusMessage').style.display = 'none';
    document.getElementById('poster-zone').style.display = 'block';
    const canvas = document.getElementById('winnerCanvas');
    const ctx = canvas.getContext('2d');
    
    // Background Clean Dark Green
    let grad = ctx.createLinearGradient(0,0,0,1250);
    grad.addColorStop(0, "#002b00");
    grad.addColorStop(1, "#004d00");
    ctx.fillStyle = grad;
    ctx.fillRect(0,0,1000,1250);
    
    // Golden Frame
    ctx.strokeStyle = "#D4AF37";
    ctx.lineWidth = 25;
    ctx.strokeRect(50,50,900,1150);
    
    // Zone Name
    ctx.fillStyle = "#D4AF37";
    ctx.font = "bold 35px Arial";
    ctx.textAlign = "center";
    ctx.fillText("SKSSF CHAPPARAPPADAV ZONE", 500, 150);
    
    // Quiz Title
    ctx.fillStyle = "white";
    ctx.font = "bold 80px Arial";
    ctx.fillText("SAMASTHA QUIZ", 500, 260);
    
    // Congratulations Text
    ctx.fillStyle = "#D4AF37";
    ctx.font = "italic 45px Arial";
    ctx.fillText("CONGRATULATIONS", 500, 420);
    
    // Winner Name (Large)
    ctx.fillStyle = "white";
    ctx.font = "bold 100px Arial";
    ctx.fillText(currentUser.name.toUpperCase(), 500, 580);
    
    // Branch
    ctx.font = "55px Arial";
    ctx.fillText("BRANCH: " + currentUser.branch.toUpperCase(), 500, 680);
    
    // Winner Badge
    ctx.fillStyle = "#D4AF37";
    ctx.beginPath();
    ctx.arc(500, 920, 130, 0, Math.PI * 2);
    ctx.fill();
    
    ctx.fillStyle = "#004d00";
    ctx.font = "bold 55px Arial";
    ctx.fillText("WINNER", 500, 940);
    
    // Footer Credit
    ctx.fillStyle = "rgba(255,255,255,0.4)";
    ctx.font = "22px Arial";
    ctx.fillText("Technical Partner: Muhsin Mannani", 500, 1200);
}

function downloadPoster() {
    const link = document.createElement('a');
    link.download = `Winner_Poster_${currentUser.name}.png`;
    link.href = document.getElementById('winnerCanvas').toDataURL("image/png", 1.0);
    link.click();
}
</script>
</body>
</html>